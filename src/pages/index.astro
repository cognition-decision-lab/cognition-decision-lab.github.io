---
import Layout from '../layouts/Layout.astro'

import { profile } from '@/settings'
import Hero from '@/components/ui/Hero.astro'
import NewsList from '@/components/ui/NewsList.jsx'

const { fullName, title, institute, research_areas } = profile

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---



<Layout>

	<!-- Hero Section -->
	<section class='flex items-center gap-12 pb-2'>
		<Hero
			fullName={fullName}
			title={title}
			institute={institute}
		/>
	</section>

	<!-- Main Content and News Side-by-Side -->
	<section class='grid grid-cols-1 md:grid-cols-12 gap-8 border-b py-10 items-stretch min-h-0'>
			<div id="aboutCol" class='md:col-span-8 text-left h-full flex flex-col min-h-0'>
					<!-- About Section -->
					<div class='about-section'>
						<h2 class='text-2xl font-bold mb-4'>About</h2>
									  <p style="text-align: justify; word-break: break-word; hyphens: auto;">
										The Cognition and Decision Lab is a joint venture among principal investigators
										<a href='http://www.columbia.edu/~mw2230/'>Michael Woodford</a>,
										<a href='http://www.columbia.edu/~md3405/'>Mark Dean</a> and
										<a href='http://www.afrouzi.com/'>Hassan Afrouzi</a>, faculty members of the Economics Department at Columbia University.
										The lab's aim is to use tools and techniques from Economics, Neuroscience, and Psychology to better understand the cognitive processes underlying economic decision making. Current projects include studying the way in which limited attention is allocated during choice and understanding the role of incomplete preferences in economic decision making. For more information, please contact one of the principal investigators.
									</p>
					</div>
										<!-- (Announcements removed) -->
										<div class='mt-8'>
											<img src='/group-photo.avif' alt='Lab Group Photo' class='w-full rounded-2xl shadow-xl' />
										</div>
			</div>
	<aside id="newsAside" class='md:col-span-4 w-full text-left md:self-stretch md:sticky md:top-28 md:h-full min-h-0'>
			<!-- Latest News Section -->
			<div id="newsCard" class='bg-base-200 text-base-content rounded-2xl p-6 shadow-xl flex flex-col h-full min-h-0'>
				<h2 class='text-2xl font-bold mb-3'>Latest News</h2>
				<div id="newsScroller" class="min-h-0 flex-1 pr-1">
					<NewsList />
				</div>
			</div>
		</aside>
	</section>

	<!-- Lab Image moved into About section above -->


<style>
	.about-section a {
		color: #2176b6;
		text-decoration: underline;
	}
</style>

<script>
	(function () {
		const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
		const px = (n) => `${Math.round(n)}px`;
			function adjustNewsHeight() {
			const about = document.getElementById('aboutCol');
			const aside = document.getElementById('newsAside');
			const card = document.getElementById('newsCard');
			const scroller = document.getElementById('newsScroller');
			if (!about || !aside || !card || !scroller) return;

				// Only equalize on md+ screens; reset on small screens
				const isMdUp = window.matchMedia('(min-width: 768px)').matches;
				if (!isMdUp) {
					card.style.removeProperty('height');
					scroller.style.removeProperty('--news-max-height');
					return;
				}

			// heights: match About+photo exactly
			const aboutH = about.getBoundingClientRect().height;
			const targetH = Math.max(aboutH, 200); // sensible minimum
			card.style.height = px(targetH);

			// Compute inner scroller max height: card - paddings - header
			const cs = getComputedStyle(card);
			const padY = (parseFloat(cs.paddingTop) || 0) + (parseFloat(cs.paddingBottom) || 0);
			const header = card.querySelector('h2');
			const headerH = header ? header.offsetHeight : 0;
			const innerMax = clamp(targetH - padY - headerH, 120, 9999);
			// Provide the height to the inner UL via CSS variable; avoid nested scrollbars
			scroller.style.setProperty('--news-max-height', px(innerMax));
			scroller.style.removeProperty('max-height');
			scroller.style.removeProperty('overflow-y');
		}

		const run = () => requestAnimationFrame(() => adjustNewsHeight());
			if (document.readyState !== 'loading') run();
			else document.addEventListener('DOMContentLoaded', run, { once: true });
			window.addEventListener('load', run, { once: true });
			// Recalc when the lab photo loads
				const photo = document.querySelector('img[alt="Lab Group Photo"]');
			if (photo) {
				if (photo.complete) run(); else photo.addEventListener('load', run, { once: true });
			}

				// Observe About column for height changes (fonts, content, image)
				if ('ResizeObserver' in window) {
					const about = document.getElementById('aboutCol');
					if (about) {
						const ro = new ResizeObserver(() => run());
						ro.observe(about);
					}
				}
		window.addEventListener('resize', run);
		document.addEventListener('astro:page-load', run);
		document.addEventListener('astro:after-swap', run);
	})();
</script>

</Layout>
